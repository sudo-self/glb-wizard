<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlbCraft Wizardry ‚ú® | Advanced 3D Model Creator</title>
    <meta name="description" content="Create magical 3D models from text, images, or primitive shapes. Export to GLB/STL with our intuitive web-based 3D modeling tool.">
    <link rel="stylesheet" href="style.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Scripts -->
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/exporters/GLTFExporter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/FontLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/geometries/TextGeometry.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/TextureLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/geometries/LatheGeometry.js"></script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6366f1">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üßô‚Äç‚ôÇÔ∏è</text></svg>">
</head>
<body>
    <custom-navbar></custom-navbar>
    
    <main class="container">
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-gradient">
                <h1 class="gradient-text">GlbCraft Wizardry üßô‚Äç‚ôÇÔ∏è</h1>
            </div>
            <p class="hero-subtitle">Transform your imagination into stunning 3D models with our magical creation tools</p>
            <div class="badges">
                <span class="badge">
                    <i data-feather="zap"></i>
                    Real-time Preview
                </span>
                <span class="badge">
                    <i data-feather="download"></i>
                    Export to GLB/STL
                </span>
                <span class="badge">
                    <i data-feather="sparkles"></i>
                    AI-Powered Features
                </span>
            </div>
        </section>

        <!-- Main Workspace -->
        <div class="workspace">
            <!-- 3D Viewer Section -->
            <section class="viewer-section">
                <div class="card glass hover-scale">
                    <div class="card-header">
                        <div class="header-content">
                            <div class="header-icon">
                                <i data-feather="eye"></i>
                            </div>
                            <div class="header-text">
                                <h2>3D Preview Canvas</h2>
                                <p>Real-time rendering of your model</p>
                            </div>
                        </div>
                        <div class="header-actions">
                            <button onclick="resetView()" class="btn btn-secondary" title="Reset camera view">
                                <i data-feather="rotate-ccw"></i>
                                <span>Reset View</span>
                            </button>
                            <button onclick="toggleWireframe()" class="btn btn-secondary" title="Toggle wireframe mode">
                                <i data-feather="grid"></i>
                                <span>Wireframe</span>
                            </button>
                            <button onclick="toggleGrid()" class="btn btn-secondary" title="Toggle grid visibility">
                                <i data-feather="layout"></i>
                                <span>Grid</span>
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="3d-container" class="canvas-container">
                            <div class="canvas-overlay"></div>
                            <div id="canvasLoading" class="canvas-loading">
                                <div class="spinner spinner-lg spinner-primary"></div>
                                <p>Loading 3D Engine...</p>
                            </div>
                        </div>
                        <div class="canvas-info">
                            <div class="canvas-controls">
                                <i data-feather="mouse-pointer"></i>
                                <span>Drag: Rotate ‚Ä¢ Scroll: Zoom ‚Ä¢ Right-click: Pan</span>
                            </div>
                            <div class="canvas-stats">
                                <span id="poly-count">0</span> polygons
                                <div class="status-indicator" title="Live rendering"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <button onclick="clearScene()" class="action-card hover-lift">
                        <i data-feather="trash-2"></i>
                        <span>Clear Scene</span>
                    </button>
                    <button onclick="saveScene()" class="action-card hover-lift">
                        <i data-feather="save"></i>
                        <span>Save Project</span>
                    </button>
                    <button onclick="loadScene()" class="action-card hover-lift">
                        <i data-feather="folder"></i>
                        <span>Load Project</span>
                    </button>
                    <button onclick="duplicateModel()" class="action-card hover-lift">
                        <i data-feather="copy"></i>
                        <span>Duplicate</span>
                    </button>
                </div>
            </section>

            <!-- Controls Panel -->
            <section class="controls-section">
                <!-- Text to 3D -->
                <div class="card hover-lift">
                    <div class="card-header">
                        <div class="header-icon-text">
                            <div class="icon-wrapper text-icon">
                                <i data-feather="type"></i>
                            </div>
                            <div class="header-text">
                                <h3>Text to 3D</h3>
                                <p>Convert text into 3D models</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="input-group">
                            <label>Enter your text</label>
                            <div class="input-with-button">
                                <input type="text"
                                       id="textInput"
                                       placeholder="Type something magical..."
                                       onkeypress="if(event.key === 'Enter') generateFromText()">
                                <button onclick="generateFromText()" class="btn btn-primary">
                                    <i data-feather="zap"></i>
                                    Generate
                                </button>
                            </div>
                        </div>
                        
                        <div class="presets">
                            <label>Quick presets</label>
                            <div class="preset-buttons">
                                <button onclick="createText3D('GLB')" class="preset-btn">
                                    <i data-feather="box"></i>
                                    GLB
                                </button>
                                <button onclick="createText3D('‚ù§Ô∏è')" class="preset-btn">
                                    <i data-feather="heart"></i>
                                    Love
                                </button>
                            </div>
                        </div>
                        
                        <div class="slider-group">
                            <div class="slider-label">
                                <label>Text Depth</label>
                                <span id="textDepthValue">0.5</span>
                            </div>
                            <input type="range"
                                   id="textDepth"
                                   min="0.1" max="2" step="0.1" value="0.5"
                                   oninput="updateTextDepth()">
                        </div>
                        
                        <div class="info-text">
                            <i data-feather="info"></i>
                            Creates extruded 3D text with customizable depth
                        </div>
                    </div>
                </div>

                <!-- Image to 3D -->
                <div class="card hover-lift">
                    <div class="card-header">
                        <div class="header-icon-text">
                            <div class="icon-wrapper image-icon">
                                <i data-feather="image"></i>
                            </div>
                            <div class="header-text">
                                <h3>Image to 3D</h3>
                                <p>Generate heightmaps from images</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="file-upload-area" id="fileUploadArea">
                            <i data-feather="upload-cloud"></i>
                            <input type="file"
                                   id="imageUpload"
                                   accept="image/*"
                                   class="hidden"
                                   onchange="handleImageUpload(event)">
                            <label for="imageUpload">
                                <span class="upload-text">Upload Image</span>
                                <span class="upload-subtext">or drag and drop</span>
                            </label>
                            <p class="upload-note">PNG, JPG, WEBP up to 10MB</p>
                        </div>
                        
                        <div class="presets">
                            <label>Sample generators</label>
                            <div class="preset-buttons">
                                <button onclick="generateFromSample('heightmap')" class="preset-btn">
                                    <i data-feather="mountain"></i>
                                    Terrain
                                </button>
                                <button onclick="generateFromSample('logo')" class="preset-btn">
                                    <i data-feather="star"></i>
                                    Logo
                                </button>
                            </div>
                        </div>
                        
                        <div class="slider-group">
                            <div class="slider-label">
                                <label>Height Scale</label>
                                <span id="heightScaleValue">1.0</span>
                            </div>
                            <input type="range"
                                   id="heightScale"
                                   min="0.1" max="5" step="0.1" value="1"
                                   oninput="updateHeightScale()">
                        </div>
                    </div>
                </div>

                <!-- Shapes & Materials -->
                <div class="card hover-lift">
                    <div class="card-header">
                        <div class="header-icon-text">
                            <div class="icon-wrapper shapes-icon">
                                <i data-feather="box"></i>
                            </div>
                            <div class="header-text">
                                <h3>Shapes & Materials</h3>
                                <p>Primitive shapes and materials</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Shape Selection -->
                        <div class="shapes-section">
                            <h4>Primitive Shapes</h4>
                            <div class="shapes-grid">
                                <button onclick="createShape('box')" class="shape-btn hover-lift">
                                    <i data-feather="cube"></i>
                                    <span>Cube</span>
                                </button>
                                <button onclick="createShape('sphere')" class="shape-btn hover-lift">
                                    <i data-feather="globe"></i>
                                    <span>Sphere</span>
                                </button>
                                <button onclick="createShape('cylinder')" class="shape-btn hover-lift">
                                    <i data-feather="disc"></i>
                                    <span>Cylinder</span>
                                </button>
                                <button onclick="createShape('torus')" class="shape-btn hover-lift">
                                    <i data-feather="circle"></i>
                                    <span>Torus</span>
                                </button>
                            </div>
                        </div>

                        <!-- Color & Material -->
                        <div class="materials-section">
                            <h4>Material & Color</h4>
                            <div class="material-controls">
                                <div class="color-picker">
                                    <label>Color</label>
                                    <input type="color"
                                           id="customColor"
                                           value="#6366f1"
                                           onchange="changeColor(this.value)">
                                </div>
                                <div class="material-select">
                                    <label>Material Type</label>
                                    <select id="materialType" onchange="changeMaterial()">
                                        <option value="phong">Shiny (Phong)</option>
                                        <option value="lambert">Matte (Lambert)</option>
                                        <option value="basic">Flat (Basic)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="color-palette">
                                <label>Quick Colors</label>
                                <div class="palette-grid">
                                    <button onclick="changeColor('#ef4444')" class="color-btn" title="Red"></button>
                                    <button onclick="changeColor('#10b981')" class="color-btn" title="Green"></button>
                                    <button onclick="changeColor('#3b82f6')" class="color-btn" title="Blue"></button>
                                    <button onclick="changeColor('#f59e0b')" class="color-btn" title="Yellow"></button>
                                    <button onclick="changeColor('#8b5cf6')" class="color-btn" title="Purple"></button>
                                    <button onclick="changeColor('#ec4899')" class="color-btn" title="Pink"></button>
                                </div>
                            </div>
                        </div>

                        <!-- Size Controls -->
                        <div class="size-controls">
                            <h4>Size Controls</h4>
                            <div class="size-sliders">
                                <div class="size-slider">
                                    <div class="slider-label">
                                        <label>Width</label>
                                        <span id="widthValue">1.0</span>
                                    </div>
                                    <input type="range"
                                           id="widthSlider"
                                           min="0.1" max="3" step="0.1" value="1"
                                           oninput="updateSize()">
                                </div>
                                <div class="size-slider">
                                    <div class="slider-label">
                                        <label>Height</label>
                                        <span id="heightValue">1.0</span>
                                    </div>
                                    <input type="range"
                                           id="heightSlider"
                                           min="0.1" max="3" step="0.1" value="1"
                                           oninput="updateSize()">
                                </div>
                                <div class="size-slider">
                                    <div class="slider-label">
                                        <label>Depth</label>
                                        <span id="depthValue">1.0</span>
                                    </div>
                                    <input type="range"
                                           id="depthSlider"
                                           min="0.1" max="3" step="0.1" value="1"
                                           oninput="updateSize()">
                                </div>
                            </div>
                        </div>

                        <!-- Export Section -->
                        <div class="export-section">
                            <h4>Export Model</h4>
                            <div class="export-buttons">
                                <button onclick="exportGLB()" class="btn btn-primary hover-glow">
                                    <i data-feather="download"></i>
                                    GLB
                                </button>
                                <button onclick="exportSTL()" class="btn btn-dark">
                                    <i data-feather="download"></i>
                                    STL
                                </button>
                            </div>
                            <div class="share-link">
                                <button onclick="shareModel()">
                                    <i data-feather="share-2"></i>
                                    Share Model Link
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Advanced Features -->
        <section class="advanced-features">
            <div class="card glass">
                <div class="card-header">
                    <h3>Advanced Features</h3>
                    <p>Coming soon: AI-powered modeling tools</p>
                </div>
                <div class="card-body">
                    <div class="features-grid">
                        <div class="feature">
                            <div class="feature-icon ai-icon">
                                <i data-feather="cpu"></i>
                            </div>
                            <h4>AI Shape Generation</h4>
                            <p>Generate complex shapes using natural language prompts</p>
                        </div>
                        <div class="feature">
                            <div class="feature-icon remesh-icon">
                                <i data-feather="refresh-cw"></i>
                            </div>
                            <h4>Smart Remeshing</h4>
                            <p>Automatically optimize polygon count while preserving details</p>
                        </div>
                        <div class="feature">
                            <div class="feature-icon materials-icon">
                                <i data-feather="layers"></i>
                            </div>
                            <h4>Material Library</h4>
                            <p>Access hundreds of pre-made materials and textures</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <custom-footer></custom-footer>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-card">
            <div class="loading-content">
                <div class="spinner spinner-lg spinner-primary"></div>
                <h3 id="loadingTitle">Processing</h3>
                <p id="loadingMessage">Please wait while we generate your model...</p>
                <div class="progress-bar">
                    <div id="loadingProgress"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="notification hidden"></div>

    <!-- Web Components -->
    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script src="script.js"></script>
    
    <script>
        // Initialize Feather Icons
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();
            
            // Initialize with a cool 3D text
            setTimeout(() => {
                createText3D('GLB');
            }, 500);
            
            // File upload area interactivity
            const fileUploadArea = document.getElementById('fileUploadArea');
            if (fileUploadArea) {
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    fileUploadArea.addEventListener(eventName, (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    }, false);
                });

                ['dragenter', 'dragover'].forEach(eventName => {
                    fileUploadArea.addEventListener(eventName, () => {
                        fileUploadArea.classList.add('drag-over');
                    }, false);
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    fileUploadArea.addEventListener(eventName, () => {
                        fileUploadArea.classList.remove('drag-over');
                    }, false);
                });

                fileUploadArea.addEventListener('drop', (e) => {
                    const files = e.dataTransfer.files;
                    if (files.length > 0 && files[0].type.startsWith('image/')) {
                        handleImageUpload({ target: { files } });
                    }
                }, false);
            }
        });

        // Show notification function
        window.showNotification = function(message, type = 'info') {
            const toast = document.getElementById('notificationToast');
            const colors = {
                info: 'info',
                success: 'success',
                warning: 'warning',
                error: 'error'
            };
            
            toast.innerHTML = `
                <div class="toast-content ${colors[type]}">
                    <i data-feather="${type === 'success' ? 'check-circle' : type === 'error' ? 'alert-circle' : 'info'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            toast.classList.remove('hidden');
            feather.replace(toast);
            
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        };
    </script>
</body>
</html>
